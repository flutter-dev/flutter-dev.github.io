<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Using Hot Reload  - Flutter </title>
  <link rel="shortcut icon" href="/images/favicon.png">

  <meta name="description" content="">
  <meta name="keywords" content=" ">

  <link rel="stylesheet" href="/css/lavish-bootstrap.css">
  <link rel="stylesheet" href="/css/main.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Extended" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro%7CRoboto:500,400italic,300,400" rel="stylesheet">
  
  <link rel="canonical" href="http://localhost:4000/hot-reload/">

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-67589403-1', 'auto');
    ga('send', 'pageview');
  </script>

  <meta name="google-site-verification" content="HFqxhSbf9YA_0rBglNLzDiWnrHiK_w4cqDh2YD2GEY4" />
</head>


  <body class="">

    <div id="overlay-under-drawer"><!-- for the drawer on narrow screens --></div>

    <header class="site-header">
  <div class="container-fluid header-contents">
    <div class="row">
      <div class="col-md-12">
        <i class="fa fa-bars" id="sidebar-toggle-button" aria-hidden="true" style="display:none"></i>
        <img src="/images/flutter-mark-square-100.png" alt="Flutter Logo" width="40" height="40" style="vertical-align:middle">

        <a class="site-title" href="/">Flutter</a>

        <nav class="site-nav">
          <a href="#" class="menu-icon">
            <i class="material-icons-extended">more_vert</i>
          </a>
          <div class="trigger">
            <a class="page-link" href="/docs/">文档</a>
            <a class="page-link" href="https://github.com/flutter/flutter">GitHub</a>
            <a class="page-link" href="https://pub.dartlang.org/flutter">库</a>
            <a class="page-link" href="/support/">支持</a>
            <a class="page-link" href="http://flutter-dev.cn">论坛</a>
            <form action="/search/" class="nav-searchbox" id="cse-search-box" style="display: inline">
              <input type="hidden" name="cx" value="007067728241810524621:gm6vraqlc8c">
              <input type="hidden" name="ie" value="UTF-8">
              <input type="hidden" name="hl" value="en">
              <input type="search" name="q" id="q" autocomplete="off" placeholder="搜索">
            </form>
          </div>
        </nav>
      </div>
    </div> <!-- /.row -->
  </div> <!-- /.container -->
</header>


    <!-- Page Content -->
    <div class="container-fluid contents">
      <!-- Content Row -->
      <div class="row">

        <!-- Sidebar Column -->
        <div id="side-nav-container" class="col-sm-3">
          <ul id="mysidebar" class="nav">

  <li class="sidebar-title">开始入门</li>

    <ul class="sidebar-items">
      <li><a href="/get-started/install/">1: 安装</a></li>
      <li><a href="/get-started/editor/">2: 配置编辑器</a></li>
      <li><a href="/get-started/test-drive/">3: 试运行</a></li>
      <li><a href="/get-started/codelab/">4: 编写第一个 Flutter 应用</a></li>
      <li><a href="/get-started/learn-more/">5: 学习更多</a></li>
    </ul>

  <li class="sidebar-title">构建 UI</li>

    <ul class="sidebar-items">
      <li><a href="/widgets-intro/">框架预览</a></li>
      <li><a href="/widgets/">部件目录</a></li>
      <li><a href="/cookbook/">小案例</a></li>
      <li><a href="/catalog/samples/">应用示例目录</a></li>
      <li><a href="https://codelabs.developers.google.com/codelabs/flutter/index.html#0">构建漂亮的用户界面 - Codelab</a></li>
      <li><a href="/tutorials/layout/">构建布局 - 教程</a></li>
      <li><a href="/tutorials/interactive/">添加交互 - 教程</a></li>
      <li><a href="/web-analogs/">HTML/CSS 模式</a></li>
      <li><a href="/flutter-for-android/">Android 开发者参考</a></li>
      <li><a href="/flutter-for-react-native/">React Native 开发者参考</a></li>
      <li><a href="/gestures/">手势</a></li>
      <li><a href="/animations/">动画</a></li>
      <li><a href="/custom-fonts/">自定义字体</a></li>
      <li><a href="/layout/">框约束</a></li>
      <li><a href="/assets-and-images/">资源与图像</a></li>
      <li><a href="/text-input/">文本输入</a></li>
      <li><a href="/routing-and-navigation/">界面路由与导航</a></li>
      <li><a href="/tutorials/internationalization">国际化</a></li>
    </ul>

  <li class="sidebar-title">使用设备与 SDK 中的 API</li>

    <ul class="sidebar-items">
      <li><a href="/using-packages/">使用扩展包</a></li>
      <li><a href="/developing-packages/">开发扩展包</a></li>
      <li><a href="/platform-channels/">平台特定代码</a></li>
      <li><a href="/reading-writing-files/">文件的读写</a></li>
      <li><a href="/networking/">网络和 HTTP</a></li>
      <li><a href="/json/">JSON 和序列化</a></li>
      
    </ul>

  <li class="sidebar-title">开发与工具</li>

    <ul class="sidebar-items">
      <li><a href="/using-ide/">Flutter IDE 的使用</a></li>
      <li><a href="/hot-reload/">热重载的使用</a></li>
      <li><a href="/testing/">应用测试</a></li>
      <li><a href="/debugging/">应用调试</a></li>
      <li><a href="/inspector/">用户界面检查</a></li>
      <li><a href="/android-release/">编译正式版的 Android 应用</a></li>
      <li><a href="/ios-release/">编译正式版的 iOS 应用</a></li>
      <li><a href="/upgrading/">升级 Flutter</a></li>
      <li><a href="/formatting/"> 格式化代码</a></li>
    </ul>

  <li class="sidebar-title">更多细节</li>

    <ul class="sidebar-items">
      <li><a href="/faq/">FAQ</a></li>
      <li><a href="/technical-overview">技术一览</a></li>
      <li><a href="https://docs.google.com/presentation/d/1B3p0kP6NV_XMOimRV09Ms75ymIjU5gr6GGIX74Om_DE/edit?usp=sharing">神奇的 Flutter - 幻灯片</a></li>
      <li><a href="https://docs.google.com/presentation/d/1cw7A4HbvM_Abv320rVgPVGiUP2msVs7tfGbkgdrTy0I/edit?usp=sharing">架构图</a></li>
      <li><a href="https://www.bilibili.com/video/av14430321/">Flutter 框架层设计 <i class="fa fa-video-camera" aria-hidden="true"></i></a></li>
      <li><a href="https://www.bilibili.com/video/av6269773/">Flutter 的渲染管线 <i class="fa fa-video-camera" aria-hidden="true"></i></a></li>
    </ul>

</ul>

        </div>

        
        

        <!-- Content Column -->
        <div class="col-sm-9 main-contents">
          <div class="main-contents-body">
            <article class="post-content">
  
  
  <header class="post-header">
      <div class="btn-group contribute" role="group">
         <a href="https://github.com/flutter/website/blob/master/hot-reload.md" class="btn btn-sm">
            <i class="fa fa-pencil"></i> Edit Source
         </a>
         <a href="https://github.com/flutter/flutter/issues/new?title=Issue from website page Using Hot Reload&body=From URL: http://localhost:4000/hot-reload.md&labels=dev: docs - website" class="btn btn-sm">
            <i class="fa fa-github"></i> File Issue
        </a>
     </div>
   <div>
    <h1 class="post-title">Using Hot Reload </h1>
   </div>

  </header>
  

  <ul id="markdown-toc">
  <li><a href="#using-hot-reload" id="markdown-toc-using-hot-reload">Using hot reload</a></li>
  <li><a href="#compilation-errors" id="markdown-toc-compilation-errors">Compilation errors</a></li>
  <li><a href="#previous-state-is-combined-with-new-code" id="markdown-toc-previous-state-is-combined-with-new-code">Previous state is combined with new code</a></li>
  <li><a href="#recent-code-change-is-included-but-app-state-is-excluded" id="markdown-toc-recent-code-change-is-included-but-app-state-is-excluded">Recent code change is included but app state is excluded</a></li>
  <li><a href="#recent-ui-change-is-excluded" id="markdown-toc-recent-ui-change-is-excluded">Recent UI change is excluded</a></li>
  <li><a href="#limitations" id="markdown-toc-limitations">Limitations</a></li>
</ul>

<h2 id="using-hot-reload">Using hot reload</h2>

<p>Flutter’s hot reload feature helps you quickly and easily experiment, build
UIs, add features, and fix bugs. Hot reload works by injecting updated source
code files into the running Dart Virtual Machine (VM). After the VM updates
classes with the new versions of fields and functions, the Flutter framework
automatically rebuilds the widget tree, allowing you to quickly view the effects
of your changes.</p>

<p>To hot reload a Flutter app:</p>

<ol>
  <li>Run the app from a supported IntelliJ IDE or a terminal window. Either a
physical or virtual device can be the target.</li>
  <li>Modify one of the Dart files in your project. Most types of code changes can
be hot reloaded; for a list of changes that require a full restart, see
<a href="#limitations">Limitations</a>.</li>
  <li>If you’re working in an IntelliJ IDE that supports Flutter’s IDE tools,
select <strong>Save All</strong> (<code class="highlighter-rouge">cmd-s</code>/<code class="highlighter-rouge">ctrl-s</code>), or click the Hot Reload button on the toolbar:</li>
</ol>

<p><img src="/images/intellij/hot-reload.gif" alt="alt_text" title="image_tooltip" /></p>

<p>If you’re running the app at the command line using <code class="highlighter-rouge">flutter run</code>, type <code class="highlighter-rouge">r</code> 
   in the terminal window.</p>

<p>After a successful hot reload operation, you’ll see a message in the console
similar to:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Performing hot reload...
Reloaded 1 of 448 libraries in 2,777ms.
</code></pre>
</div>
<p>The app is updated to reflect your change, and the current state of the app
— the value of the counter variable in the above example — is preserved. Your
app continues to execute from where it was prior to running the hot reload
command. The code is updated and execution continues.</p>

<p>A code change has a visible effect only if the modified Dart code is run again
after the change. The next sections describe common situations where the
modified code will <em>not</em> run again after hot reload. In some cases, 
small changes to the Dart code will enable you to continue using hot reload
for your app.</p>

<h2 id="compilation-errors">Compilation errors</h2>

<p>When a code change introduces a compilation error, hot reload always generates
an error message similar to:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>Hot reload was rejected:
'/Users/obiwan/Library/Developer/CoreSimulator/Devices/AC94F0FF-16F7-46C8-B4BF-218B73C547AC/data/Containers/Data/Application/4F72B076-42AD-44A4-A7CF-57D9F93E895E/tmp/ios_testWIDYdS/ios_test/lib/main.dart': warning: line 16 pos 38: unbalanced '{' opens here
  Widget build(BuildContext context) {
                                     ^
'/Users/obiwan/Library/Developer/CoreSimulator/Devices/AC94F0FF-16F7-46C8-B4BF-218B73C547AC/data/Containers/Data/Application/4F72B076-42AD-44A4-A7CF-57D9F93E895E/tmp/ios_testWIDYdS/ios_test/lib/main.dart': error: line 33 pos 5: unbalanced ')'
    );
    ^
</code></pre>
</div>
<p>In this situation, simply correct the errors on the specified lines of
Dart code to keep using hot reload.</p>

<h2 id="previous-state-is-combined-with-new-code">Previous state is combined with new code</h2>

<p>Flutter’s hot reload feature, sometimes described as <em>stateful hot reload</em>,
preserves the state of your app. This design enables you to view
the effect of the most recent change only, without throwing away the
current state. For example, if your app requires a user to log in, you can
modify and hot reload a page several levels down in the navigation hierarchy,
without re-entering your login credentials. State is kept, which is 
usually the desired behavior.</p>

<p>If code changes affect the state of your app (or its dependencies), 
the data your app has to work with might not be fully consistent with 
the data it would have if it executed from scratch. The result might be 
different behavior after hot reload versus a full restart.</p>

<p>For example, if you modify a class definition from extending StatelessWidget
to StatefulWidget (or the reverse), after hot reload the previous state of
your app is preserved. However, the state might not be compatible with the
new changes.</p>

<p>Consider the following code:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>class myWidget extends StatelessWidget {
  Widget build(BuildContext context) {
    return new GestureDetector(onTap: () =&gt; print('T'));
  }
}
</code></pre>
</div>
<p>After running the app, if you make the following change:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>class myWidget extends StatefulWidget {
  @override
  State createState() =&gt; new myWidgetState();
}
class myWidgetState {
...
...
}
</code></pre>
</div>

<p>and then hot reload, the console displays an assertion failure similar to:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>myWidget is not a subtype of StatelessWidget
</code></pre>
</div>

<p>In these situations, a full restart is needed to see the updated app.</p>

<h2 id="recent-code-change-is-included-but-app-state-is-excluded">Recent code change is included but app state is excluded</h2>

<p>In Dart, <a href="https://news.dartlang.org/2012/02/static-variables-no-longer-have-to-be.html">static fields are lazily initialized</a>. This means that the first time you run a Flutter app and a static
field is read, it is set to whatever value its initializer was evaluated to.
Global variables and static fields are treated as state, and thus not 
reinitialized during hot reload.</p>

<p>If you change initializers of global variables and static fields, a full 
restart is necessary to see the changes. For example, consider the
following code:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>final sampleTable = [
  new Table("T1"),
  new Table("T2"),
  new Table("T3"),
  new Table("T4"),
];
</code></pre>
</div>
<p>After running the app, if you make the following change:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>final sampleTable = [
  new Table("T1"),
  new Table("T2"),
  new Table("T3"),
  new Table("T10"),    //modified
];
</code></pre>
</div>
<p>and then hot reload, the change is not reflected.</p>

<p>Conversely, in the following example:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>const foo = 1;
final bar = foo;
void onClick(){
  print(foo);
  print(bar);
}
</code></pre>
</div>
<p>running the app for the first time prints <code class="highlighter-rouge">1</code> and <code class="highlighter-rouge">1</code>. Then if you make the
following change:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>const foo = 2;    //modified
final bar = foo;
void onClick(){
  print(foo);
  print(bar);
}
</code></pre>
</div>
<p>and hot reload, it now prints <code class="highlighter-rouge">2</code> and <code class="highlighter-rouge">1</code>. While changes to <code class="highlighter-rouge">const</code> field values
are always hot reloaded, the static field initializer is not rerun.
Conceptually, <code class="highlighter-rouge">const</code> fields are treated like aliases instead of state.</p>

<p>The Dart VM detects initializer changes and flags when a set of changes needs a
full restart to take effect. The flagging mechanism is triggered for most of the
initialization work in the above example, but not for cases like:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>final bar = foo;
</code></pre>
</div>

<p>To be able to update <code class="highlighter-rouge">foo</code> and view the change after hot reload, consider
redefining the field as <code class="highlighter-rouge">const</code> or using a getter to return the value, rather
than using <code class="highlighter-rouge">final</code>. For example:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>const bar = foo;
</code></pre>
</div>
<p>or:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>get bar =&gt; foo;
</code></pre>
</div>

<p>Read more about the <a href="https://news.dartlang.org/2012/06/const-static-final-oh-my.html">differences between the <code class="highlighter-rouge">const</code> and <code class="highlighter-rouge">final</code> keywords</a> in Dart.</p>

<h2 id="recent-ui-change-is-excluded">Recent UI change is excluded</h2>

<p>Even when a hot reload operation appears successful and generates no exceptions,
some code changes might not be visible in the refreshed UI. This behavior is
common after changes to the app’s <code class="highlighter-rouge">main()</code> method.</p>

<p>As a general rule, if the modified code is downstream of the root widget’s
build method, then hot reload behaves as expected. However, if the modified code
won’t be re-executed as a result of rebuilding the widget tree, then you won’t
see its effects after hot reload.</p>

<p>For example, consider the following code:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>import 'package:flutter/material.dart';

void main() {
  runApp(new MyApp());
}

class MyApp extends StatelessWidget {
  Widget build(BuildContext context) {
    return new GestureDetector(
      onTap: () =&gt; print('tapped'));
  }
}
</code></pre>
</div>

<p>After running this app, you might change the code as follows:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>import 'package:flutter/widgets.dart';
void main() {
  runApp(
    const Center(
      child: const Text('Hello', textDirection: TextDirection.ltr)));
  }
</code></pre>
</div>

<p>With a full restart, the program starts from the beginning, executes the new
version of <code class="highlighter-rouge">main()</code>, and builds a widget tree that displays the text <code class="highlighter-rouge">Hello</code>.</p>

<p>However, if you hot reload the app after this change, <code class="highlighter-rouge">main()</code> is not 
re-executed, and the widget tree is rebuilt with the unchanged instance of 
<code class="highlighter-rouge">MyApp</code> as the root widget. The result is no visible change after hot reload.</p>

<h2 id="limitations">Limitations</h2>

<p>You might also encounter the rare cases where hot reload is not supported
at all. These include:</p>

<ul>
  <li>
    <p>Enumerated types are changed to regular classes or regular classes are
changed to enumerated types. For example, if you change:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code> enum Color {
   red,
   green,
   blue
 }

</code></pre>
    </div>
    <p>to:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code> class Color {
   Color(this.i, this.j);
   final Int i;
   final Int j;
 	}
</code></pre>
    </div>
  </li>
  <li>
    <p>Generic type declarations are modified. For example, if you change:</p>
    <div class="highlighter-rouge"><pre class="highlight"><code>class A&lt;T&gt; {
  T i;
}
</code></pre>
    </div>
    <p>to:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>class A&lt;T, V&gt; {
  T i;
  V v;
}
</code></pre>
    </div>
  </li>
</ul>

<p>In these situations, hot reload generates a diagnostic message and fails without
committing any changes.</p>

</article>

          </div>
        </div>

        

      </div> <!-- /.row -->
    </div> <!-- /.container -->

    <footer class="site-footer">
  <div class="container-fluid">
    <div class="row">
      <div class="col-sm-12">
        <div class="logo">
          <img src="/images/flutter-mark-square-100.png" alt="Flutter Logo" width="100" height="100">
        </div>
        <p class="site-footer__link-list">
          <a href="https://groups.google.com/forum/#!forum/flutter-dev">flutter-dev@</a> &bull;
          <a href="https://twitter.com/flutterio">twitter</a> &bull;
          <a href="https://github.com/flutter/">github</a> &bull;
          <a href="/tos">terms</a> &bull;
          <a href="https://www.google.com/intl/en/policies/privacy/">privacy</a> &bull;
          <a href="https://github.com/orgs/flutter-dev/teams/flutter/">翻译组</a>
        </p>

        <p class="licenses">
          除非另有说明，否则本作品根据
          <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">知识共享署名 4.0 国际许可证</a>进行许可，代码示例已根据 BSD 许可证进行许可。
        </p>
      </div>
    </div>
  </div>
</footer>

    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="/js/sidebar_toggle.js"></script>
    <script src="/js/customscripts.js"></script>
    <script src="/js/prism.js"></script>
    <script src="/js/tabs.js"></script>
    
    <script async="" defer="" src="//survey.g.doubleclick.net/async_survey?site=at3ul57xpub2vk3oxt2ytw365i"></script>
  </body>
</html>
