<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>编写第一个 Flutter 应用  - Flutter </title>
  <link rel="shortcut icon" href="/images/favicon.png">

  <meta name="description" content="">
  <meta name="keywords" content=" ">

  <link rel="stylesheet" href="/css/lavish-bootstrap.css">
  <link rel="stylesheet" href="/css/main.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Extended" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro%7CRoboto:500,400italic,300,400" rel="stylesheet">
  
  <link rel="canonical" href="http://localhost:4000/get-started/codelab/">

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-67589403-1', 'auto');
    ga('send', 'pageview');
  </script>

  <meta name="google-site-verification" content="HFqxhSbf9YA_0rBglNLzDiWnrHiK_w4cqDh2YD2GEY4" />
</head>


  <body class="">

    <div id="overlay-under-drawer"><!-- for the drawer on narrow screens --></div>

    <header class="site-header">
  <div class="container-fluid header-contents">
    <div class="row">
      <div class="col-md-12">
        <i class="fa fa-bars" id="sidebar-toggle-button" aria-hidden="true" style="display:none"></i>
        <img src="/images/flutter-mark-square-100.png" alt="Flutter Logo" width="40" height="40" style="vertical-align:middle">

        <a class="site-title" href="/">Flutter</a>

        <nav class="site-nav">
          <a href="#" class="menu-icon">
            <i class="material-icons-extended">more_vert</i>
          </a>
          <div class="trigger">
            <a class="page-link" href="/docs/">文档</a>
            <a class="page-link" href="/showcase/">案例</a>
            <a class="page-link" href="https://github.com/flutter/flutter">GitHub</a>
            <a class="page-link" href="https://pub.dartlang.org/flutter">库</a>
            <a class="page-link" href="/support/">支持</a>
            <a class="page-link" href="http://flutter-dev.cn">中文开发者论坛</a>
            <form action="/search/" class="nav-searchbox" id="cse-search-box" style="display: inline">
              <input type="hidden" name="cx" value="007067728241810524621:gm6vraqlc8c">
              <input type="hidden" name="ie" value="UTF-8">
              <input type="hidden" name="hl" value="en">
              <input type="search" name="q" id="q" autocomplete="off" placeholder="搜索">
            </form>
          </div>
        </nav>
      </div>
    </div> <!-- /.row -->
  </div> <!-- /.container -->
</header>


    <!-- Page Content -->
    <div class="container-fluid contents">
      <!-- Content Row -->
      <div class="row">

        <!-- Sidebar Column -->
        <div id="side-nav-container" class="col-sm-3">
          <ul id="mysidebar" class="nav">

  <li class="sidebar-title">入门</li>

    <ul class="sidebar-items">
      <li><a href="/get-started/install/">1: 安装</a></li>
      <li><a href="/get-started/editor/">2: 配置编辑器</a></li>
      <li><a href="/get-started/test-drive/">3: Flutter 初体验</a></li>
      <li><a href="/get-started/codelab/">4: 编写第一个 Flutter 应用</a></li>
      <li><a href="/get-started/learn-more/">5: 学习更多</a></li>
    </ul>

  <li class="sidebar-title">构建 UI</li>

    <ul class="sidebar-items">
      <li><a href="/widgets-intro/">框架预览</a></li>
      <li><a href="/widgets/">Widget 目录</a></li>
      <li><a href="/cookbook/">小案例</a></li>
      <li><a href="/catalog/samples/">示例目录</a></li>
      <li><a href="/codelabs">Codelab</a></li>
      <li><a href="/tutorials/layout/">构建布局 - 教程</a></li>
      <li><a href="/tutorials/interactive/">添加交互 - 教程</a></li>
      <li><a href="/web-analogs/"> Web 开发者参考</a></li>
      <li><a href="/flutter-for-android/">Android 开发者参考</a></li>
      <li><a href="/flutter-for-ios/">iOS 开发者参考</a></li>
      <li><a href="/flutter-for-react-native/">React Native 开发者参考</a></li>
      <li><a href="/gestures/">手势</a></li>
      <li><a href="/animations/">动画</a></li>
      <li><a href="/layout/">框约束</a></li>
      <li><a href="/assets-and-images/">资源与图像</a></li>
      <li><a href="/tutorials/internationalization">国际化</a></li>
      <li><a href="/accessibility">无障碍</a></li>
    </ul>

  <li class="sidebar-title">使用设备与 SDK 中的 API</li>

    <ul class="sidebar-items">
      <li><a href="/using-packages/">使用扩展包</a></li>
      <li><a href="/developing-packages/">开发扩展包</a></li>
      <li><a href="/platform-channels/">平台特定代码</a></li>
      <li><a href="/json/">JSON 和序列化</a></li>
      
    </ul>

  <li class="sidebar-title">开发与工具</li>

    <ul class="sidebar-items">
      <li><a href="/using-ide/">Flutter IDE 的使用</a></li>
      <li><a href="/hot-reload/">热重载的使用</a></li>
      <li><a href="/testing/">应用测试</a></li>
      <li><a href="/debugging/">应用调试</a></li>
      <li><a href="/ui-performance/">性能分析</a></li>
      <li><a href="/inspector/">用户界面检查</a></li>
      <li><a href="/android-release/">编译正式版的 Android 应用</a></li>
      <li><a href="/ios-release/">编译正式版的 iOS 应用</a></li>
      <li><a href="/fastlane-cd/">使用 Fastlane 持续部署</a></li>
      <li><a href="/upgrading/">升级 Flutter</a></li>
      <li><a href="/formatting/"> 格式化代码</a></li>
    </ul>

  <li class="sidebar-title">更多细节</li>

    <ul class="sidebar-items">
      <li><a href="/faq/">FAQ</a></li>
      <li><a href="/technical-overview">技术一览</a></li>
      <li><a href="https://docs.google.com/presentation/d/1B3p0kP6NV_XMOimRV09Ms75ymIjU5gr6GGIX74Om_DE/edit?usp=sharing">神奇的 Flutter - 幻灯片</a></li>
      <li><a href="https://docs.google.com/presentation/d/1cw7A4HbvM_Abv320rVgPVGiUP2msVs7tfGbkgdrTy0I/edit?usp=sharing">架构图</a></li>
      <li><a href="https://www.bilibili.com/video/av14430321/">Flutter 框架层设计 <i class="fa fa-video-camera" aria-hidden="true"></i></a></li>
      <li><a href="https://www.bilibili.com/video/av6269773/">Flutter 的渲染管线 <i class="fa fa-video-camera" aria-hidden="true"></i></a></li>
    </ul>

</ul>

        </div>

        
        

        <!-- Content Column -->
        <div class="col-sm-9 main-contents">
          <div class="main-contents-body">
            <article class="post-content">
  
  
  <header class="post-header">
      <div class="btn-group contribute" role="group">
         <a href="https://github.com/flutter/website/blob/master/zh_CN/get-started/codelab/index.md" class="btn btn-sm">
            <i class="fa fa-pencil"></i> Edit Source
         </a>
         <a href="https://github.com/flutter/flutter/issues/new?title=Issue from website page 编写第一个 Flutter 应用&body=From URL: http://localhost:4000/get-started/codelab/&labels=dev: docs - website" class="btn btn-sm">
            <i class="fa fa-github"></i> File Issue
        </a>
     </div>
   <div>
    <h1 class="post-title">编写第一个 Flutter 应用 </h1>
   </div>

  </header>
  

  

<figure class="right-figure" style="max-width: 260px; padding-right: 10px">
    <img src="images/startup-namer-app.gif" alt="Animated GIF of the app that you will be building." style="border: 10px solid #333; border-radius: 10px; margin-bottom: 10px" />
</figure>
<p>这篇教程将指导你创建第一个 Flutter 应用程序。如果你熟悉面向对象程序设计和基本的编程概念（如变量，循环和条件），即可完成本教程。无需具有使用 Dart 语言或移动编程的相关经验。</p>

<ul id="markdown-toc">
  <li><a href="#第1步创建初始flutter应用" id="markdown-toc-第1步创建初始flutter应用">第1步：创建初始Flutter应用</a></li>
  <li><a href="#第2步使用外部-package" id="markdown-toc-第2步使用外部-package">第2步：使用外部 package</a></li>
  <li><a href="#第3步添加有状态的widget" id="markdown-toc-第3步添加有状态的widget">第3步：添加有状态的widget</a></li>
  <li><a href="#第4步创建一个无限滚动的-listview" id="markdown-toc-第4步创建一个无限滚动的-listview">第4步：创建一个无限滚动的 ListView</a></li>
  <li><a href="#第5步添加可交互性" id="markdown-toc-第5步添加可交互性">第5步：添加可交互性</a></li>
  <li><a href="#第6步导航到新页面" id="markdown-toc-第6步导航到新页面">第6步：导航到新页面</a></li>
  <li><a href="#第7步使用主题更改ui" id="markdown-toc-第7步使用主题更改ui">第7步：使用主题更改UI</a></li>
  <li><a href="#干得漂亮" id="markdown-toc-干得漂亮">干得漂亮！</a></li>
</ul>

<p class="h2-like">你需要做什么</p>

<p>完成一个简单的移动应用程序，为一家创业公司进行命名推荐。用户可以选择和取消选择名称，并保存最好的一个。代码一次生成十个名称。当用户滚动时，会新生成一批名称。用户可以点击应用栏右上方的列表图标，跳转到仅显示已被收藏的名称的列表页面。</p>

<p>这个GIF动画可以显示出该应用是如何工作的。</p>

<div class="whats-the-point">

  <p><b> <a id="whats-the-point" class="anchor" href="#whats-the-point" aria-hidden="true"><span class="octicon octicon-link"></span></a>你将会学到:</b></p>

  <ul>
    <li>Flutter 应用程序的基本结构。</li>
    <li>查找和使用 package 来扩展功能。</li>
    <li>使用热加载加快开发效率。</li>
    <li>如何实现一个有状态的 widget 。</li>
    <li>如何创建一个无限长度的延迟加载列表。</li>
    <li>如何创建并导航到第二个页面。</li>
    <li>如何使用主题更改应用程序的外观。</li>
  </ul>

</div>

<div class="whats-the-point">

  <p><b> <a id="whats-the-point" class="anchor" href="#whats-the-point" aria-hidden="true"><span class="octicon octicon-link"></span></a>你将会用到:</b></p>

  <p>需要安装以下工具:</p>

  <ul>
<li>
      <p>Flutter SDK<br />
    Flutter SDK 包括 Flutter 的引擎，框架，控件，工具和 Dart SDK 。这个 codelab 需要 v0.1.4 或更高版本。</p>
    </li>
<li>
      <p>Android Studio IDE<br />
    这个 codelab 基于 Android Studio IDE 构建，但也可以使用其他 IDE ，或者从命令行运行。</p>
    </li>
<li>
      <p>安装 IDE 插件<br />
    插件必须为您的编译器单独安装 Flutter 和 Dart 插件。除了Android Studio，Flutter和Dart插件也可用于 <a href="https://code.visualstudio.com/download">VS Code</a> 和
    <a href="https://www.jetbrains.com/idea/download/#section=mac">IntelliJ</a>IDE。</p>
    </li>
</ul>

  <p>有关如何设置环境的信息，请参阅 <a href="/get-started/install/">Flutter安装和配置</a>。</p>

</div>

<h1 id="第1步创建初始flutter应用">第1步：创建初始Flutter应用</h1>

<p>使用<a href="/get-started/test-drive/#create-app">第一个入门 Flutter 应用</a>中的说明创建一个简单的模板化 Flutter 应用。将项目命名为 <strong>startup_namer</strong>（而不是<em>myapp</em>）。你将修改这个应用并最终完成它。</p>

<p>在这个 codelab 中，将主要编辑 Dart 代码所在的 <strong>lib / main.dart</strong>。</p>

<aside class="alert alert-success">
  <p><i class="fa fa-lightbulb-o"> </i> <strong>小贴士：</strong>
将代码粘贴到应用程序中时，缩进可能会错位。你可以使用 Flutter 工具自动修复此问题：</p>

  <ul>
    <li>Android Studio / IntelliJ IDEA: 右键单击 dart 代码，然后选择 <strong>Reformat Code with dartfmt</strong>。</li>
    <li>VS Code: 单击右键，选择 <strong>Format Document</strong>.</li>
    <li>命令行: 运行 <code class="highlighter-rouge">flutter format &lt;filename&gt;</code>.</li>
  </ul>
</aside>

<ol>

<li>
    <p>替换 lib / main.dart 。<br />
删除 <strong>lib / main.dart</strong> 中的所有代码。替换为下面的代码，它在屏幕中心显示 “Hello World” 。</p>

    <pre class="prettyprint highlighter-rouge highlight lang-dart language-dart"><code>import &#39;package:flutter/material.dart&#39;;

void main() =&gt; runApp(new MyApp());

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return new MaterialApp(
      title: &#39;Welcome to Flutter&#39;,
      home: new Scaffold(
        appBar: new AppBar(
          title: new Text(&#39;Welcome to Flutter&#39;),
        ),
        body: new Center(
          child: new Text(&#39;Hello World&#39;),
        ),
      ),
    );
  }
}</code></pre>
  </li>

<li>
    <p>运行应用程序。现在应该可以看到下面的页面。</p>

    <center><img src="images/hello-world-screenshot.png" alt="screenshot of hello world app" /></center>
  </li>
</ol>

<p class="h2-like">小结</p>

<ul>
  <li>
    <p>本示例创建了一个 Material app 。
      <a href="https://material.io/guidelines/">Material</a> 设计语言是一套移动设备和网页上的视觉设计标准。Flutter 提供了一套丰富的 Material Widgets 。</p>
  </li>
  <li>
    <p>main 方法采用了 fat arrow (<code class="highlighter-rouge">=&gt;</code>) 表示法，这是一种用于单行函数或方法的简写。</p>
  </li>
  <li>
    <p>该 app 继承了使它本身成为一个 widget 的 StatelessWidget 类。在 Flutter 中，大多数时候一切都可以看作 widget , 包括 alignment，padding 和 layout 。</p>
  </li>
  <li>
    <p>Material 库中的 Scaffold widget 提供了默认的应用栏  (app bar)，标题和构成主页面 widget 树结构的 body 属性。 widget 的子树可以非常复杂。</p>
  </li>
  <li>
    <p>widget 的主要工作是提供一个<code class="highlighter-rouge">build()</code>方法，描述如何根据其他更低层级的 widget，来对这个 widget 进行展示。</p>
  </li>
  <li>
    <p>本示例的 widget 树由包含了 Text child widget 的 Center widget 组成。Center widget 可将它的所有子树对齐到屏幕中心。</p>
  </li>
</ul>

<hr />

<h1 id="第2步使用外部-package">第2步：使用外部 package</h1>

<p>在这一步，将开始使用名为 <strong>english_words</strong> 的开源软件包 ，其中包含数千个最常用的英文单词以及一些实用功能。</p>

<p>可以在 <a href="https://pub.dartlang.org/flutter/">pub.dartlang.org</a> 上找到 <a href="https://pub.dartlang.org/packages/english_words">english_words</a> 软件包以及其他许多开源软件包。</p>

<ol>

<li>
    <p>pubspec 文件管理着 Flutter 应用程序的静态资源文件(assets)。
    在 <strong>pubspec.yaml</strong> 文件中， 将 <strong>english_words</strong>（3.1.0或更高版本）添加到依赖列表。新的一行高亮如下：</p>

    <!-- skip -->
    <pre class="prettyprint highlighter-rouge highlight lang-dart language-dart"><code>dependencies:
  flutter:
    sdk: flutter

  cupertino_icons: ^0.1.0
  <span class="nocode highlight">english_words: ^3.1.0</span></code></pre>
  </li>

<li>
    <p>在 Android Studio 的 editor 视图中查看 pubspec 时,
    点击右上角的 <strong>Packages get</strong> ，将把 package 拉取到项目中。现在应该可以在控制台中看到以下内容：</p>

    <!-- skip -->
    <pre class="prettyprint highlighter-rouge highlight lang-dart language-dart"><code>flutter packages get
Running &quot;flutter packages get&quot; in startup_namer...
Process finished with exit code 0</code></pre>
  </li>

<li>
    <p>在 <strong>lib/main.dart</strong> 中，为 <code class="highlighter-rouge">english_words</code> 添加导入，如高亮的行所示：</p>

    <!-- skip -->
    <pre class="prettyprint highlighter-rouge highlight lang-dart language-dart"><code>import &#39;package:flutter/material.dart&#39;;
<span class="nocode highlight">import &#39;package:english_words/english_words.dart&#39;;</span></code></pre>

    <p>在键入该行时， Android Studio 会提供有关库导入的建议。然后将导入字符串显示为灰色，让你知道导入的库尚未使用（到目前为止）。</p>
  </li>

<li>
    <p>改用英文单词的 package 来生成文本，而不是字符串 “Hello World” 。</p>

    <aside class="alert alert-success">
      <p><i class="fa fa-lightbulb-o"> </i> <strong>小贴士：</strong>
“Pascal case”（也被称为“大骆驼拼写法”），意味着字符串中的每个单词（包括第一个单词）都以大写字母开头。所以，“uppercamelcase” 变成 “UpperCamelCase” 。</p>
    </aside>

    <p>对代码进行以下更改，如高亮所示：</p>

    <!-- skip -->
    <pre class="prettyprint highlighter-rouge highlight lang-dart language-dart"><code>import &#39;package:flutter/material.dart&#39;;
import &#39;package:english_words/english_words.dart&#39;;

void main() =&gt; runApp(new MyApp());

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    <span class="nocode highlight">final wordPair = new WordPair.random();</span>
    return new MaterialApp(
      title: &#39;Welcome to Flutter&#39;,
      home: new Scaffold(
        appBar: new AppBar(
          title: new Text(&#39;Welcome to Flutter&#39;),
        ),
        body: new Center(
          //child: new Text(<span class="nocode highlight">&#39;Hello World&#39;</span>), // Replace the highlighted text...
          child: new Text(<span class="nocode highlight">wordPair.asPascalCase</span>),  // With this highlighted text.
        ),
      ),
    );
  }
}</code></pre>
  </li>

<li>
    <p>如果应用正在运行，请使用 Flutter Hot Reload (热重载)按钮
    (<img src="images/hot-reload-button.png" alt="lightning bolt icon" />)更新应用程序。每次单击按钮或保存项目时，都会看到随机的词组文本，这是因为配对的词组是在 build 方法内部生成的，每次应用需要渲染时，或在 Flutter Inspector 中切换 Platform 时都会运行</p>

    <center><img src="images/step2-screenshot.png" alt="screenshot at completion of second step" /></center>
  </li>

</ol>

<p class="h2-like">有问题吗？</p>

<p>如果应用程序运行不正常，请检查拼写错误。如有需要，可使用以下链接中的代码使项目恢复正常</p>

<ul>
  <li><a href="https://gist.githubusercontent.com/Sfshaza/bb51e3b7df4ebbf3dfd02a4a38db2655/raw/57c25b976ec34d56591cb898a3df0b320e903b99/pubspec.yaml"><strong>pubspec.yaml</strong></a>
(<strong>pubspec.yaml</strong>文件不会再更改。)</li>
  <li><a href="https://gist.githubusercontent.com/Sfshaza/bb51e3b7df4ebbf3dfd02a4a38db2655/raw/57c25b976ec34d56591cb898a3df0b320e903b99/main.dart"><strong>lib/main.dart</strong></a></li>
</ul>

<hr />

<h1 id="第3步添加有状态的widget">第3步：添加有状态的widget</h1>

<p>State<em>less</em> widgets 是不可改变的，这意味着它们的属性不能改变——所有的值都是 final 的。</p>

<p>State<em>ful</em>widget 在其生命周期保持的状态可能会变化，实现一个有状态的 widget 至少需要两个类：StatefulWidgets类和State类，其中StatefulWidgets类创建了一个State类的实例。StatefulWidget类本身是不可变的，但State类可存在于Widget的整个生命周期中。</p>

<p>在这一步，将添加一个有状态的 RandomWords widget ，它可以创建其 State 类 RandomWordsState 。 State 类会为 widget 保存被推荐和被收藏的词组。</p>

<ol>
<li>
    <p>将有状态的 RandomWords widget 添加到 main.dart 。它可以在 MyApp 类之外的任何位置使用，但当前将把它放在文件底部。 RandomWords widget 除了创建 State 类之外几乎没有任何其他代码：</p>

    <!-- skip -->
    <pre class="prettyprint highlighter-rouge highlight lang-dart language-dart"><code>class RandomWords extends StatefulWidget {
  @override
  createState() =&gt; new RandomWordsState();
}</code></pre>
  </li>

<li>
    <p>添加 RandomWordsState 类。这个类保存了 RandomWords widget 的状态，该应用程序的大部分代码都放在该类中。这个类将保存随着用户的滑动操作而生成的无限增长的词组，以及保存用户收藏的词组，用户通过触发心形图标来添加或删除收藏的词组列表。</p>

    <p>你可以一点点建立这个类。首先，通过以下高亮代码，创建一个最简的类：</p>

    <!-- skip -->
    <pre class="prettyprint highlighter-rouge highlight lang-dart language-dart"><code><span class="nocode highlight">class RandomWordsState extends State&lt;RandomWords&gt; {</span>
<span class="nocode highlight">}</span></code></pre>
  </li>

<li>
    <p>添加这个 state 类之后，IDE 会提示该类缺少 build 方法。接下来，需要添加一个基本的 build 方法，并将生成单词的代码行从 MyApp 类移动到 RandomWordsState 类的 build 方法中，生成词组。</p>

    <p>将 build 方法添加到 RandomWordState 中，如高亮代码所示：</p>

    <!-- skip -->
    <pre class="prettyprint highlighter-rouge highlight lang-dart language-dart"><code>class RandomWordsState extends State&lt;RandomWords&gt; {
  <span class="nocode highlight">@override</span>
  <span class="nocode highlight">Widget build(BuildContext context) {</span>
    <span class="nocode highlight">final wordPair = new WordPair.random();</span>
    <span class="nocode highlight">return new Text(wordPair.asPascalCase);</span>
  <span class="nocode highlight">}</span>
}</code></pre>
  </li>

<li>
    <p>根据高亮部分的更改，从 MyApp 中删除生成单词的代码：</p>

    <!-- skip -->
    <pre class="prettyprint highlighter-rouge highlight lang-dart language-dart"><code>class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    <span class="nocode strike">final wordPair = new WordPair.random();</span>  // Delete this line

    return new MaterialApp(
      title: &#39;Welcome to Flutter&#39;,
      home: new Scaffold(
        appBar: new AppBar(
          title: new Text(&#39;Welcome to Flutter&#39;),
       ),
        body: new Center(
          //child: new <span class="nocode highlight">Text(wordPair.asPascalCase),</span> // Change the highlighted text to...
          child: new <span class="nocode highlight">RandomWords(),</span> // ... this highlighted text
        ),
      ),
    );
  }
}</code></pre>
  </li>

</ol>

<p>重启应用。如果尝试热重载，则可能会看到警告:</p>

<pre class="prettyprint highlighter-rouge highlight lang-sh language-sh"><code>Reloading...
Not all changed program elements ran during view reassembly; consider
restarting.</code></pre>

<p>这可能是一个误报，但可以考虑重启应用，以确保更改能正常反映在应用的 UI 界面中。</p>

<p>应用程序应该像之前一样运行，每次热重载或保存应用程序时都会显示一个词组。</p>

<center><img src="images/step3-screenshot.png" alt="screenshot at completion of third step" /></center>

<p class="h2-like">有问题吗?</p>

<p>如果应用运行不正常，则可以使用以下链接中的代码使其恢复正常</p>

<ul>
  <li><a href="https://gist.githubusercontent.com/Sfshaza/d7f13ddd8888556232476be8578efe40/raw/329c397b97309ce99f834bf70ebb90778baa5cfe/main.dart"><strong>lib/main.dart</strong></a></li>
</ul>

<hr />

<h1 id="第4步创建一个无限滚动的-listview">第4步：创建一个无限滚动的 ListView</h1>

<p>在这一步，可以扩展 RandomWordsState 类，生成并展示词组列表。当用户滑动列表，ListView widget 中显示的列表将无限增长。 ListView 的 <code class="highlighter-rouge">builder</code> 工厂构造函数允许按需建立一个延迟加载的列表 view 。</p>

<ol>

<li>
    <p><code class="highlighter-rouge">_suggestions</code> 变量向 RandomWordsState 类中添加一个数组列表，用来保存推荐词组。 该变量以下划线(<code class="highlighter-rouge">_</code>)开头，在 Dart 语言中使用下划线前缀表示强制私有。</p>

    <p>此外，添加一个 <code class="highlighter-rouge">biggerFont</code> 变量来增大字体。</p>

    <!-- skip -->
    <pre class="prettyprint highlighter-rouge highlight lang-dart language-dart"><code>class RandomWordsState extends State&lt;RandomWords&gt; {
  <span class="nocode highlight">final _suggestions = &lt;WordPair&gt;[];</span>

  <span class="nocode highlight">final _biggerFont = const TextStyle(fontSize: 18.0);</span>
  ...
}</code></pre>
  </li>

<li>
    <p>向 RandomWordsState 类添加一个 <code class="highlighter-rouge">_buildSuggestions()</code> 函数，用于构建一个显示词组的 ListView 。</p>

    <p>ListView 类提供了一个 <code class="highlighter-rouge">itemBuilder</code> 属性，这是一个工厂 builder 并作为匿名函数进行回调。它有两个传入参数— BuildContext 上下文和行迭代器 <code class="highlighter-rouge">i</code> 。对于每个推荐词组都会执行一次函数调用，迭代器从 0 开始，每调用一次函数就累加 1 。这个模块允许推荐列表在用户滑动时无限增长。</p>

    <p>添加如下高亮代码行：</p>

    <!-- skip -->
    <pre class="prettyprint highlighter-rouge highlight lang-dart language-dart"><code>class RandomWordsState extends State&lt;RandomWords&gt; {
  ...
  <span class="nocode highlight">Widget _buildSuggestions() {</span>
    <span class="nocode highlight">return new ListView.builder(</span>
      <span class="nocode highlight">padding: const EdgeInsets.all(16.0),</span>
      // The itemBuilder callback is called once per suggested word pairing,
      // and places each suggestion into a ListTile row.
      // For even rows, the function adds a ListTile row for the word pairing.
      // For odd rows, the function adds a Divider widget to visually
      // separate the entries. Note that the divider may be difficult
      // to see on smaller devices.
      <span class="nocode highlight">itemBuilder: (context, i) {</span>
        // Add a one-pixel-high divider widget before each row in theListView.
        <span class="nocode highlight">if (i.isOdd) return new Divider();</span>

        // The syntax &quot;i ~/ 2&quot; divides i by 2 and returns an integer result.
        // For example: 1, 2, 3, 4, 5 becomes 0, 1, 1, 2, 2.
        // This calculates the actual number of word pairings in the ListView,
        // minus the divider widgets.
        <span class="nocode highlight">final index = i ~/ 2;</span>
        // If you&#39;ve reached the end of the available word pairings...
        <span class="nocode highlight">if (index &gt;= _suggestions.length) {</span>
          // ...then generate 10 more and add them to the suggestions list.
          <span class="nocode highlight">_suggestions.addAll(generateWordPairs().take(10));</span>
        <span class="nocode highlight">}</span>
        <span class="nocode highlight">return _buildRow(_suggestions[index]);</span>
      <span class="nocode highlight">}</span>
    <span class="nocode highlight">);</span>
  <span class="nocode highlight">}</span>
}</code></pre>
  </li>

<li>
    <p>对于每个词组，<code class="highlighter-rouge">_buildSuggestions</code> 函数都调用一次 <code class="highlighter-rouge">_buildRow</code> 函数。这个函数每次会在一个 ListTile widget 中展示一条新词组，这将在下一步操作中，使一行数据更有表现力。</p>

    <p>添加 <code class="highlighter-rouge">_buildRow</code> 函数到 RandomWordsState 类中：</p>

    <!-- skip -->
    <pre class="prettyprint highlighter-rouge highlight lang-dart language-dart"><code>class RandomWordsState extends State&lt;RandomWords&gt; {
  ...

  <span class="nocode highlight">Widget _buildRow(WordPair pair) {</span>
    <span class="nocode highlight">return new ListTile(</span>
      <span class="nocode highlight">title: new Text(</span>
        <span class="nocode highlight">pair.asPascalCase,</span>
        <span class="nocode highlight">style: _biggerFont,</span>
      <span class="nocode highlight">),</span>
    <span class="nocode highlight">);</span>
  <span class="nocode highlight">}</span>
}</code></pre>
  </li>

<li>
    <p>更新 RandomWordsState 类的 build 方法来使用 <code class="highlighter-rouge">_buildSuggestions()</code> 函数，而不是直接调用单词生成库。对高亮部分进行修改：</p>

    <!-- skip -->
    <pre class="prettyprint highlighter-rouge highlight lang-dart language-dart"><code>class RandomWordsState extends State&lt;RandomWords&gt; {
  ...
  @override
  Widget build(BuildContext context) {
    <span class="nocode strike">final wordPair = new WordPair.random();</span> // Delete these two lines.
    <span class="nocode strike">Return new Text(wordPair.asPascalCase);</span>
    <span class="nocode highlight">return new Scaffold (</span>
      <span class="nocode highlight">appBar: new AppBar(</span>
        <span class="nocode highlight">title: new Text(&#39;Startup Name Generator&#39;),</span>
      <span class="nocode highlight">),</span>
    <span class="nocode highlight">body: _buildSuggestions(),</span>
    <span class="nocode highlight">);</span>
  }
  ...
}</code></pre>
  </li>

<li>
    <p>更新 MyApp 类的 build 方法。从 MyApp 中删除 Scaffold 和 AppBar 实例。这些将由 RandomWordsState 类进行统一管理，这样在下一步操作中，可以使用户从一个页面导航到另一页面时，更方便的更改应用栏中的页面名称。</p>

    <p>用下面高亮的 build 方法替换原始代码：</p>

    <!-- skip -->
    <pre class="prettyprint highlighter-rouge highlight lang-dart language-dart"><code>class MyApp extends StatelessWidget {
  @override
  <span class="nocode highlight">Widget build(BuildContext context) {</span>
    <span class="nocode highlight">return new MaterialApp(</span>
      <span class="nocode highlight">title: &#39;Startup Name Generator&#39;,</span>
      <span class="nocode highlight">home: new RandomWords(),</span>
    <span class="nocode highlight">);</span>
  <span class="nocode highlight">}</span>
}</code></pre>
  </li>

</ol>

<p>重启应用程序，将可以看到一个词组清单。尽量向下滑动，将继续看到新的词组。</p>

<center><img src="images/step4-screenshot.png" alt="screenshot at completion of fourth step" /></center>

<p class="h2-like">有问题吗?</p>

<p>如果应用运行不正常，则可以使用以下链接中的代码使其恢复正常</p>

<ul>
  <li><a href="https://gist.githubusercontent.com/Sfshaza/d6f9460a04d3a429eb6ac0b0f07da564/raw/34fe240f4122435c871bb737708ee0357741801c/main.dart"><strong>lib/main.dart</strong></a></li>
</ul>

<hr />

<h1 id="第5步添加可交互性">第5步：添加可交互性</h1>

<p>在这一步，将为每一行添加可点击的心形图标。当用户点击列表中的条目，切换其“收藏”状态，词组就会添加到收藏栏，或从已保存词组的收藏栏中删除。</p>

<ol>
<li>
    <p>添加一个 Set 集合 <code class="highlighter-rouge">_saved</code> 到 RandomWordsState 类。保存用户收藏的词组。Set 集合比 List 更适用于此，因为它不允许重复元素。</p>

    <!-- skip -->
    <pre class="prettyprint highlighter-rouge highlight lang-dart language-dart"><code>class RandomWordsState extends State&lt;RandomWords&gt; {
  final _suggestions = &lt;WordPair&gt;[];

  <span class="nocode highlight">final _saved = new Set&lt;WordPair&gt;();</span>

  final _biggerFont = const TextStyle(fontSize: 18.0);
  ...
}</code></pre>
  </li>

<li>
    <p>在 <code class="highlighter-rouge">_buildRow</code> 函数中，添加 <code class="highlighter-rouge">alreadySaved</code> 标志检查来确保一个词组还没有被添加到收藏。</p>

    <!-- skip -->
    <pre class="prettyprint highlighter-rouge highlight lang-dart language-dart"><code>Widget _buildRow(WordPair pair) {
  <span class="nocode highlight">final alreadySaved = _saved.contains(pair);</span>
  ...
}</code></pre>
  </li>

<li>
    <p>在 <code class="highlighter-rouge">_buildRow()</code> 的 ListTiles widget 中，添加一个心形图标来使用收藏功能，随后将添加与心形图标进行交互的功能。</p>

    <p>添加以下高亮代码行：</p>

    <!-- skip -->
    <pre class="prettyprint highlighter-rouge highlight lang-dart language-dart"><code>Widget _buildRow(WordPair pair) {
  final alreadySaved = _saved.contains(pair);
  return new ListTile(
    title: new Text(
      pair.asPascalCase,
      style: _biggerFont,
    ),
    <span class="nocode highlight">trailing: new Icon(</span>
      <span class="nocode highlight">alreadySaved ? Icons.favorite : Icons.favorite_border,</span>
      <span class="nocode highlight">color: alreadySaved ? Colors.red : null,</span>
    <span class="nocode highlight">),</span>
  );
}</code></pre>
  </li>

<li>
    <p>重启应用。现在应该可以在每一行看到心形图标，但还没有交互功能。</p>
  </li>

<li>
    <p>在 <code class="highlighter-rouge">_buildRow</code> 函数中使心形可点击。如果词条已经被加入收藏，再次点击它将从收藏中删除。当心形图标被点击，函数将调用 <code class="highlighter-rouge">setState()</code> 通知应用框架state已经改变。</p>

    <p>添加高亮代码行：</p>

    <!-- skip -->
    <pre class="prettyprint highlighter-rouge highlight lang-dart language-dart"><code>Widget _buildRow(WordPair pair) {
  final alreadySaved = _saved.contains(pair);
  return new ListTile(
    title: new Text(
      pair.asPascalCase,
      style: _biggerFont,
    ),
    trailing: new Icon(
      alreadySaved ? Icons.favorite : Icons.favorite_border,
      color: alreadySaved ? Colors.red : null,
    ),
    <span class="nocode highlight">onTap: () {</span>
      <span class="nocode highlight">setState(() {</span>
        <span class="nocode highlight">if (alreadySaved) {</span>
          <span class="nocode highlight">_saved.remove(pair);</span>
        <span class="nocode highlight">} else {</span>
          <span class="nocode highlight">_saved.add(pair);</span>
        <span class="nocode highlight">}</span>
      <span class="nocode highlight">});</span>
    <span class="nocode highlight">},</span>
  );
}</code></pre>
  </li>
</ol>

<aside class="alert alert-success">
  <p><i class="fa fa-lightbulb-o"> </i> <strong>小贴士：</strong>
在 Flutter 的响应式风格框架中，调用 <code class="highlighter-rouge">setState()</code> ，将为 State 对象触发 <code class="highlighter-rouge">build()</code> 方法的调用，从而实现对UI的更新。</p>
</aside>

<p>热重载应用。可以点击任意一行来收藏或取消收藏条目。 请注意，点击一行可以产生从心形图标展开的泼墨动画效果。</p>

<center><img src="images/step5-screenshot.png" alt="screenshot at completion of 5th step" /></center>

<p class="h2-like">有问题吗?</p>

<p>如果应用运行不正常，则可以使用以下链接中的代码使其恢复正常。</p>

<ul>
  <li><a href="https://gist.githubusercontent.com/Sfshaza/936ce0059029a8c6e88aaa826a3789cd/raw/a3065d5c681a81eff32f75a9cd5f4d9a5b24f9ff/main.dart"><strong>lib/main.dart</strong></a></li>
</ul>

<hr />

<h1 id="第6步导航到新页面">第6步：导航到新页面</h1>

<p>在这一步，将添加一个显示收藏夹的新页面(在 Flutter 中称为 <em>route(路由)</em>)。你将学习如何在主路由和新路由之间导航。</p>

<p>在 Flutter 中， Navigator 管理着包含了应用程序所有路由的一个堆栈。将一个路由push到 Navigator 的堆栈，将显示更新为新页面路由。将一个路由 pull 出 Navigator 的堆栈，显示将返回到前一个页面路由。</p>

<ol>
<li>
    <p>在 RandomWordsState 类的 build 方法中，向 AppBar 添加一个列表图标。当用户点击列表图标时，包含了已收藏条目的新路由将被 push 到 Navigator 堆栈并显示新页面。</p>

    <aside class="alert alert-success">
      <p><i class="fa fa-lightbulb-o"> </i> <strong>小贴士：</strong>
某些 widget 属性使用独立 widget(<code class="highlighter-rouge">child</code>) 和其他属性例如 <code class="highlighter-rouge">action</code> 组成一个子 widget 数组(<code class="highlighter-rouge">children</code>)，用方括号(<code class="highlighter-rouge">[]</code>)表示。</p>
    </aside>

    <p>将该图标及其相应的 action 操作添加到 build 方法中：</p>

    <!-- skip -->
    <pre class="prettyprint highlighter-rouge highlight lang-dart language-dart"><code>class RandomWordsState extends State&lt;RandomWords&gt; {
  ...
  @override
  Widget build(BuildContext context) {
    return new Scaffold(
      appBar: new AppBar(
        title: new Text(&#39;Startup Name Generator&#39;),
        <span class="nocode highlight">actions: &lt;Widget&gt;[</span>
          <span class="nocode highlight">new IconButton(icon: new Icon(Icons.list), onPressed: _pushSaved),</span>
        <span class="nocode highlight">],</span>
      ),
      body: _buildSuggestions(),
    );
  }
  ...
}</code></pre>
  </li>

<li>
    <p>向 RandomWordsState 类添加一个 <code class="highlighter-rouge">_pushSaved()</code> 函数。</p>

    <!-- skip -->
    <pre class="prettyprint highlighter-rouge highlight lang-dart language-dart"><code>class RandomWordsState extends State&lt;RandomWords&gt; {
  ...
  <span class="nocode highlight">void _pushSaved() {</span>
  <span class="nocode highlight">}</span>
}</code></pre>

    <p>重新加载应用程序。列表图标将出现在应用栏中。点击它不会有任何响应，因为 <code class="highlighter-rouge">_pushSaved</code> 这个函数还未实现功能。</p>
  </li>

<li>
    <p>当用户点击应用栏中的列表图标时，将建立一个新路由并 push 到 Navigator 的路由堆栈中，这个操作将改变界面显示，展示新的路由页面。</p>

    <p>新页面的内容使用匿名函数在 MaterialPageRoute widget的<code class="highlighter-rouge">builder</code>属性中创建。</p>

    <p>将函数调用添加到 Navigator.push 中作为参数,如高亮代码所示，将路由 push 到 Navigator 的堆栈中。</p>

    <!-- skip -->
    <pre class="prettyprint highlighter-rouge highlight lang-dart language-dart"><code><span class="nocode highlight">void _pushSaved() {</span>
  <span class="nocode highlight">Navigator.of(context).push(</span>
  <span class="nocode highlight">);</span>
<span class="nocode highlight">}</span></code></pre>
  </li>

<li>
    <p>添加 MaterialPageRoute widget 及其 builder 属性。先添加生成 ListTile  widget 的代码。其中 ListTile 的 <code class="highlighter-rouge">divideTiles()</code> 方法为每个 ListTile widget 之间添加水平间距。<code class="highlighter-rouge">divided</code>变量保存最终生成的所有行，并用 <code class="highlighter-rouge">toList()</code> 函数转换为列表。</p>

    <!-- skip -->
    <pre class="prettyprint highlighter-rouge highlight lang-dart language-dart"><code>void _pushSaved() {
  Navigator.of(context).push(
    <span class="nocode highlight">new MaterialPageRoute(</span>
      <span class="nocode highlight">builder: (context) {</span>
        <span class="nocode highlight">final tiles = _saved.map(</span>
              <span class="nocode highlight">(pair) {</span>
            <span class="nocode highlight">return new ListTile(</span>
              <span class="nocode highlight">title: new Text(</span>
                <span class="nocode highlight">pair.asPascalCase,</span>
                <span class="nocode highlight">style: _biggerFont,</span>
              <span class="nocode highlight">),</span>
            <span class="nocode highlight">);</span>
          <span class="nocode highlight">},</span>
        <span class="nocode highlight">);</span>
        <span class="nocode highlight">final divided = ListTile</span>
            <span class="nocode highlight">.divideTiles(</span>
          <span class="nocode highlight">context: context,</span>
          <span class="nocode highlight">tiles: tiles,</span>
        <span class="nocode highlight">)</span>
            <span class="nocode highlight">.toList();</span>
      <span class="nocode highlight">},</span>
    <span class="nocode highlight">),</span>
  );
}</code></pre>
  </li>

<li>
    <p>builder 属性返回一个 Scaffold widget ，其中包含了应用栏标题名为 “Saved Suggestions” 的新路由页面。新页面的body属性由包含多个 ListTile widget 的 ListView 组成。</p>

    <p>添加如下高亮代码：</p>

    <!-- skip -->
    <pre class="prettyprint highlighter-rouge highlight lang-dart language-dart"><code>void _pushSaved() {
  Navigator.of(context).push(
    new MaterialPageRoute(
      builder: (context) {
        final tiles = _saved.map(
              (pair) {
            return new ListTile(
              title: new Text(
                pair.asPascalCase,
                style: _biggerFont,
              ),
            );
          },
        );
        final divided = ListTile
            .divideTiles(
          context: context,
          tiles: tiles,
        )
            .toList();

        <span class="nocode highlight">return new Scaffold(</span>
          <span class="nocode highlight">appBar: new AppBar(</span>
            <span class="nocode highlight">title: new Text(&#39;Saved Suggestions&#39;),</span>
          <span class="nocode highlight">),</span>
          <span class="nocode highlight">body: new ListView(children: divided),</span>
        <span class="nocode highlight">);</span>
      },
    ),
  );
}</code></pre>
  </li>

<li>
    <p>热重载应用程序。对一些条目点击收藏，然后点击应用栏右侧的列表图标。显示出包含收藏夹列表的新页面。注意，Navigator 会在应用栏左侧添加一个“返回”按钮。不必再显式实现 Navigator.pop 。点击返回按钮会返回到主页面。</p>
  </li>
</ol>

<center><img src="images/step6a-screenshot.png" alt="screenshot at completion of 6th step" /><img src="images/step6b-screenshot.png" alt="second route" /></center>

<p class="h2-like">有问题吗?</p>

<p>如果应用运行不正常，则可以使用以下链接中的代码使其恢复正常。</p>

<ul>
  <li><a href="https://gist.github.com/Sfshaza/bc5547e112e4dc3a1aa87afdf917caeb"><strong>lib/main.dart</strong></a></li>
</ul>

<hr />
<h1 id="第7步使用主题更改ui">第7步：使用主题更改UI</h1>

<p>在最后一步中，将使用该应用的主题。 <em>theme</em> 控制的是应用程序的观感。可以使用默认主题，该主题取决于使用的模拟器或真机，也可以自定义主题以反映你的品牌。</p>

<ol>
<li>
    <p>可以通过配置 ThemeData 类轻松更改应用程序的主题。应用程序目前使用默认主题，现在将更改主要颜色为白色。</p>

    <p>将高亮代码添加到 MyApp 类中，可以把应用程序的主题更改为白色：</p>

    <!-- skip -->
    <pre class="prettyprint highlighter-rouge highlight lang-dart language-dart"><code>class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return new MaterialApp(
      title: &#39;Startup Name Generator&#39;,
      <span class="nocode highlight">theme: new ThemeData(</span>
        <span class="nocode highlight">primaryColor: Colors.white,</span>
      <span class="nocode highlight">),</span>
      home: new RandomWords(),
    );
  }
}</code></pre>
  </li>

<li>
    <p>热重载应用程序。请注意，整个背景都是白色的，甚至包括应用栏。</p>
  </li>

<li>
    <p>作为读者的练习，可使用 <a href="https://docs.flutter.io/flutter/material/ThemeData-class.html">ThemeData</a> 来改变用户界面的其他方面。 Material 库中的 <a href="https://docs.flutter.io/flutter/material/Colors-class.html">Colors</a> 类提供了多种可以使用的颜色常量，而热重载使用户界面的修改变得简单快捷。</p>
  </li>
</ol>

<center><img src="images/step7-themes.png" alt="screenshot at completion of 7th step" /></center>

<p class="h2-like">有问题吗?</p>

<p>如果又不能正常运行了，请使用以下链接中的代码查看最终应用的代码。</p>

<ul>
  <li><a href="https://gist.githubusercontent.com/Sfshaza/c07c91a4061fce4b5eacaaf4d82e4993/raw/4001a72c0133b97c8e16bdeb3195ca03525696bd/main.dart"><strong>lib/main.dart</strong></a></li>
</ul>

<hr />

<h1 id="干得漂亮">干得漂亮！</h1>

<p>您已经编写了一个可在 iOS 和 Android 上运行的交互式 Flutter 应用程序。在这个codelab中，已经完成了：</p>

<ul>
  <li>从头开始创建一个 Flutter 应用程序。</li>
  <li>编写 Dart 语言代码。</li>
  <li>使用外部的第三方库。</li>
  <li>使用热重载加快开发。</li>
  <li>实现了一个有状态的 widget，为你的应用增加可交互性。</li>
  <li>用 ListView 和 ListTiles 创建了一个延迟加载的无限滚动列表。</li>
  <li>创建了一个路由，并添加在主页面路由和新路由之间跳转的逻辑。</li>
  <li>学习如何使用主题更改应用程序的UI外观。</li>
</ul>

<p class="h2-like">下一步</p>

<p><a href="/get-started/learn-more/">下一步: 学习更多</a></p>


</article>

          </div>
        </div>

        

      </div> <!-- /.row -->
    </div> <!-- /.container -->

    <footer class="site-footer">
  <div class="container-fluid">
    <div class="row">
      <div class="col-sm-12">
        <div class="logo">
          <img src="/images/flutter-mark-square-100.png" alt="Flutter Logo" width="100" height="100">
        </div>
        <p class="site-footer__link-list">
          <a href="https://groups.google.com/forum/#!forum/flutter-dev">flutter-dev@</a> &bull;
          <a href="https://twitter.com/flutterio">twitter</a> &bull;
          <a href="https://github.com/flutter/">github</a> &bull;
          <a href="/tos">terms</a> &bull;
          <a href="https://www.google.com/intl/en/policies/privacy/">privacy</a> &bull;
          <a href="https://github.com/orgs/flutter-dev/teams/flutter/">翻译组</a>
        </p>

        <p class="licenses">
          除非另有说明，否则本作品根据
          <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">知识共享署名 4.0 国际许可证</a>进行许可，代码示例已根据 BSD 许可证进行许可。
        </p>
      </div>
    </div>
  </div>
</footer>

    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="/js/sidebar_toggle.js"></script>
    <script src="/js/customscripts.js"></script>
    <script src="/js/prism.js"></script>
    <script src="/js/tabs.js"></script>
    <script src="/js/archive.js"></script>
    
    <script async="" defer="" src="//survey.g.doubleclick.net/async_survey?site=at3ul57xpub2vk3oxt2ytw365i"></script>
  </body>
</html>
