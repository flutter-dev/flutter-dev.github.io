<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>JSON and serialization  - Flutter </title>
  <link rel="shortcut icon" href="/images/favicon.png">

  <meta name="description" content="">
  <meta name="keywords" content=" ">

  <link rel="stylesheet" href="/css/lavish-bootstrap.css">
  <link rel="stylesheet" href="/css/main.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Extended" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro%7CRoboto:500,400italic,300,400" rel="stylesheet">
  
  <link rel="canonical" href="http://localhost:4000/json/">

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-67589403-1', 'auto');
    ga('send', 'pageview');
  </script>

  <meta name="google-site-verification" content="HFqxhSbf9YA_0rBglNLzDiWnrHiK_w4cqDh2YD2GEY4" />
</head>


  <body class="">

    <div id="overlay-under-drawer"><!-- for the drawer on narrow screens --></div>

    <header class="site-header">
  <div class="container-fluid header-contents">
    <div class="row">
      <div class="col-md-12">
        <i class="fa fa-bars" id="sidebar-toggle-button" aria-hidden="true" style="display:none"></i>
        <img src="/images/flutter-mark-square-100.png" alt="Flutter Logo" width="40" height="40" style="vertical-align:middle">

        <a class="site-title" href="/">Flutter</a>

        <nav class="site-nav">
          <a href="#" class="menu-icon">
            <i class="material-icons-extended">more_vert</i>
          </a>
          <div class="trigger">
            <a class="page-link" href="/docs/">文档</a>
            <a class="page-link" href="https://github.com/flutter/flutter">GitHub</a>
            <a class="page-link" href="https://pub.dartlang.org/flutter">库</a>
            <a class="page-link" href="/support/">支持</a>
            <a class="page-link" href="http://flutter-dev.cn/bbs">论坛</a>
            <form action="/search/" class="nav-searchbox" id="cse-search-box" style="display: inline">
              <input type="hidden" name="cx" value="007067728241810524621:gm6vraqlc8c">
              <input type="hidden" name="ie" value="UTF-8">
              <input type="hidden" name="hl" value="en">
              <input type="search" name="q" id="q" autocomplete="off" placeholder="搜索">
            </form>
          </div>
        </nav>
      </div>
    </div> <!-- /.row -->
  </div> <!-- /.container -->
</header>


    <!-- Page Content -->
    <div class="container-fluid contents">
      <!-- Content Row -->
      <div class="row">

        <!-- Sidebar Column -->
        <div id="side-nav-container" class="col-sm-3">
          <ul id="mysidebar" class="nav">

  <li class="sidebar-title">开始入门</li>

    <ul class="sidebar-items">
      <li><a href="/get-started/install/">1: 安装</a></li>
      <li><a href="/get-started/editor/">2: 配置编辑器</a></li>
      <li><a href="/get-started/test-drive/">3: 试运行</a></li>
      <li><a href="/get-started/codelab/">4: 编写第一个 Flutter 应用</a></li>
      <li><a href="/get-started/learn-more/">5: 学习更多</a></li>
    </ul>

  <li class="sidebar-title">构建 UI</li>

    <ul class="sidebar-items">
      <li><a href="/widgets-intro/">框架预览</a></li>
      <li><a href="/widgets/">部件目录</a></li>
      <li><a href="/cookbook/">小案例</a></li>
      <li><a href="/catalog/samples/">应用示例目录</a></li>
      <li><a href="https://codelabs.developers.google.com/codelabs/flutter/index.html#0">构建漂亮的用户界面 - Codelab</a></li>
      <li><a href="/tutorials/layout/">构建布局 - 教程</a></li>
      <li><a href="/tutorials/interactive/">添加交互 - 教程</a></li>
      <li><a href="/web-analogs/">HTML/CSS 模式</a></li>
      <li><a href="/flutter-for-android/">Android 开发者参考</a></li>
      <li><a href="/flutter-for-react-native/">React Native 开发者参考</a></li>
      <li><a href="/gestures/">手势</a></li>
      <li><a href="/animations/">动画</a></li>
      <li><a href="/custom-fonts/">自定义字体</a></li>
      <li><a href="/layout/">框约束</a></li>
      <li><a href="/assets-and-images/">资源与图像</a></li>
      <li><a href="/text-input/">文本输入</a></li>
      <li><a href="/routing-and-navigation/">界面路由与导航</a></li>
      <li><a href="/tutorials/internationalization">国际化</a></li>
    </ul>

  <li class="sidebar-title">使用设备与 SDK 中的 API</li>

    <ul class="sidebar-items">
      <li><a href="/using-packages/">使用扩展包</a></li>
      <li><a href="/developing-packages/">开发扩展包</a></li>
      <li><a href="/platform-channels/">平台特定代码</a></li>
      <li><a href="/reading-writing-files/">文件的读写</a></li>
      <li><a href="/networking/">网络和 HTTP</a></li>
      <li><a href="/json/">JSON 和序列化</a></li>
      
    </ul>

  <li class="sidebar-title">开发与工具</li>

    <ul class="sidebar-items">
      <li><a href="/using-ide/">Flutter IDE 的使用</a></li>
      <li><a href="/hot-reload/">热重载的使用</a></li>
      <li><a href="/testing/">应用测试</a></li>
      <li><a href="/debugging/">应用调试</a></li>
      <li><a href="/inspector/">用户界面检查</a></li>
      <li><a href="/android-release/">编译正式版的 Android 应用</a></li>
      <li><a href="/ios-release/">编译正式版的 iOS 应用</a></li>
      <li><a href="/upgrading/">升级 Flutter</a></li>
      <li><a href="/formatting/"> 格式化代码</a></li>
    </ul>

  <li class="sidebar-title">更多细节</li>

    <ul class="sidebar-items">
      <li><a href="/faq/">FAQ</a></li>
      <li><a href="/technical-overview">技术一览</a></li>
      <li><a href="https://docs.google.com/presentation/d/1B3p0kP6NV_XMOimRV09Ms75ymIjU5gr6GGIX74Om_DE/edit?usp=sharing">神奇的 Flutter - 幻灯片</a></li>
      <li><a href="https://docs.google.com/presentation/d/1cw7A4HbvM_Abv320rVgPVGiUP2msVs7tfGbkgdrTy0I/edit?usp=sharing">架构图</a></li>
      <li><a href="https://www.bilibili.com/video/av14430321/">Flutter 框架层设计 <i class="fa fa-video-camera" aria-hidden="true"></i></a></li>
      <li><a href="https://www.bilibili.com/video/av6269773/">Flutter 的渲染管线 <i class="fa fa-video-camera" aria-hidden="true"></i></a></li>
    </ul>

</ul>

        </div>

        
        

        <!-- Content Column -->
        <div class="col-sm-9 main-contents">
          <div class="main-contents-body">
            <article class="post-content">
  
  
  <header class="post-header">
      <div class="btn-group contribute" role="group">
         <a href="https://github.com/flutter/website/blob/master/json.md" class="btn btn-sm">
            <i class="fa fa-pencil"></i> Edit Source
         </a>
         <a href="https://github.com/flutter/flutter/issues/new?title=Issue from website page JSON and serialization&body=From URL: http://localhost:4000/json.md&labels=dev: docs - website" class="btn btn-sm">
            <i class="fa fa-github"></i> File Issue
        </a>
     </div>
   <div>
    <h1 class="post-title">JSON and serialization </h1>
   </div>

  </header>
  

  <p>It is hard to think of a mobile app that doesn’t need to communicate with a web
server or easily store structured data at some point. When making
network-connected apps, the chances are that we need to consume some good old
JSON, sooner or later.</p>

<p>In this tutorial, we look into ways of using JSON with Flutter. We go over what
JSON solution to use in different scenarios and why.</p>

<ul id="markdown-toc">
  <li><a href="#which-json-serialization-method-is-right-for-me" id="markdown-toc-which-json-serialization-method-is-right-for-me">Which JSON serialization method is right for me?</a>    <ul>
      <li><a href="#use-manual-serialization-for-smaller-projects" id="markdown-toc-use-manual-serialization-for-smaller-projects">Use manual serialization for smaller projects</a></li>
      <li><a href="#use-code-generation-for-medium-to-large-projects" id="markdown-toc-use-code-generation-for-medium-to-large-projects">Use code generation for medium to large projects</a></li>
    </ul>
  </li>
  <li><a href="#is-there-a-gsonjacksonmoshi-equivalent-in-flutter" id="markdown-toc-is-there-a-gsonjacksonmoshi-equivalent-in-flutter">Is there a GSON/Jackson/Moshi equivalent in Flutter?</a></li>
  <li><a href="#serializing-json-manually-using-dartconvert" id="markdown-toc-serializing-json-manually-using-dartconvert">Serializing JSON manually using dart:convert</a>    <ul>
      <li><a href="#serializing-json-inline" id="markdown-toc-serializing-json-inline">Serializing JSON inline</a></li>
      <li><a href="#serializing-json-inside-model-classes" id="markdown-toc-serializing-json-inside-model-classes">Serializing JSON inside model classes</a></li>
    </ul>
  </li>
  <li><a href="#serializing-json-using-code-generation-libraries" id="markdown-toc-serializing-json-using-code-generation-libraries">Serializing JSON using code generation libraries</a>    <ul>
      <li><a href="#setting-up-json_serializable-in-a-project" id="markdown-toc-setting-up-json_serializable-in-a-project">Setting up json_serializable in a project</a></li>
      <li><a href="#creating-model-classes-the-json_serializable-way" id="markdown-toc-creating-model-classes-the-json_serializable-way">Creating model classes the json_serializable way</a></li>
      <li><a href="#running-the-code-generation-utility" id="markdown-toc-running-the-code-generation-utility">Running the code generation utility</a>        <ul>
          <li><a href="#one-time-code-generation" id="markdown-toc-one-time-code-generation">One-time code generation</a></li>
          <li><a href="#generating-code-continuously" id="markdown-toc-generating-code-continuously">Generating code continuously</a></li>
        </ul>
      </li>
      <li><a href="#consuming-json_serializable-models" id="markdown-toc-consuming-json_serializable-models">Consuming json_serializable models</a></li>
    </ul>
  </li>
  <li><a href="#further-references" id="markdown-toc-further-references">Further references</a></li>
</ul>

<h2 id="which-json-serialization-method-is-right-for-me">Which JSON serialization method is right for me?</h2>

<p>This article covers two general strategies for working with JSON:</p>

<ul>
  <li>Manual serialization and deserialization</li>
  <li>Automated serialization and deserialization via code generation</li>
</ul>

<p>Different projects come with different complexities and use cases. For smaller
proof-of-concept projects or quick prototypes, using code generators might be
overkill. For apps with several JSON models with more complexity, doing
serialization by hand can quickly become tedious, repetitive and lend itself to
lots of small errors.</p>

<h3 id="use-manual-serialization-for-smaller-projects">Use manual serialization for smaller projects</h3>

<p>Manual JSON serialization refers to using the built-in JSON decoder in
<code class="highlighter-rouge">dart:convert</code>. It involves passing the raw JSON string to the <code class="highlighter-rouge">JSON.decode()</code>
method, and then looking up the values you need in the <code class="highlighter-rouge">Map&lt;String, dynamic&gt;</code>
the method returns. It has no external dependencies or particular setup process,
and it is good for quick proof of concepts.</p>

<p>Where the manual serialization does not perform well is when your project
becomes bigger. Writing the serialization logic by hand can become hard to
manage and error-prone. If you have a typo when accessing an unexisting JSON
field, your code throws an error during runtime.</p>

<p>If you do not have many JSON models in your project and are looking to test a
concept quickly, manual serialization might be the way you want to start. For an
example of manual serialization, <a href="#manual-serialization">see here</a>.</p>

<h3 id="use-code-generation-for-medium-to-large-projects">Use code generation for medium to large projects</h3>

<p>JSON serialization with code generation means having an external library
generate the serialization boilerplate for you. They involve some initial setup
and running a file watcher that generates the code from your model classes. For
example,
<a href="https://pub.dartlang.org/packages/json_serializable">json_serializable</a> and
<a href="https://pub.dartlang.org/packages/built_value">built_value</a> are these kinds of
libraries.</p>

<p>This approach scales well for a larger project. There is no hand-written
boilerplate needed, and typos when accessing JSON fields are caught at
compile-time. The downside with code generation is that it involves some initial
setup. Also, the generated source files may produce visual clutter in your
project navigator</p>

<p>You might want to use generated code for JSON serialization when you have a
medium or a larger project. To see an example of code generation based JSON
serialization, <a href="#code-generation">see here</a>.</p>

<h2 id="is-there-a-gsonjacksonmoshi-equivalent-in-flutter">Is there a GSON/Jackson/Moshi equivalent in Flutter?</h2>

<p>The simple answer is no.</p>

<p>Such a library would require using runtime reflection, which is disabled in
Flutter. Runtime reflection interferes with <em>tree shaking</em>, which Dart has
supported for quite a long time. With tree shaking, we can “shake off” unused
code from our release builds. This allows us to optimize the size of our
applications significantly.</p>

<p>Since reflection makes all code implicitly used by default, it makes tree
shaking difficult. The tools cannot know what parts are unused at runtime, so
the redundant code is hard to strip away. App sizes cannot be easily optimized
when using reflection.</p>

<aside class="alert alert-info">
  <p><strong>What about dartson?</strong></p>

  <p>The <a href="https://pub.dartlang.org/packages/dartson">dartson</a> library uses runtime
reflection, which makes it not compatible with Flutter.</p>
</aside>

<p>Although we cannot use runtime reflection with Flutter, some libraries give us
similarly easy to use APIs but are based on code generation instead. This
approach is covered in more detail in the <a href="#code-generation">code generation
libraries</a> section.</p>

<p><a name="manual-serialization"></a></p>
<h2 id="serializing-json-manually-using-dartconvert">Serializing JSON manually using dart:convert</h2>

<p>Basic JSON serialization in Flutter is very simple. Flutter has a built-in
<code class="highlighter-rouge">dart:convert</code> library, which includes a straightforward JSON encoder and
decoder.</p>

<p>Here is an example JSON for a simple user model.</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John Smith"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"john@example.com"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>With <code class="highlighter-rouge">dart:convert</code>, we can serialize this JSON model in two ways. Let’s have a
look at both.</p>

<h3 id="serializing-json-inline">Serializing JSON inline</h3>

<p>By looking at <a href="https://api.dartlang.org/stable/1.24.3/dart-convert/JsonCodec-class.html">the dart:convert JSON
documentation</a>,
we see that we can decode the JSON by calling the <code class="highlighter-rouge">JSON.decode</code> method, with our
JSON string as the method argument.</p>

<!-- skip -->
<div class="language-dart highlighter-rouge"><pre class="highlight"><code><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">,</span> <span class="kd">dynamic</span><span class="o">&gt;</span> <span class="n">user</span> <span class="o">=</span> <span class="n">JSON</span><span class="o">.</span><span class="na">decode</span><span class="o">(</span><span class="n">json</span><span class="o">);</span>

<span class="n">print</span><span class="o">(</span><span class="s">'Howdy, </span><span class="si">${user['name']}</span><span class="s">!'</span><span class="o">);</span>
<span class="n">print</span><span class="o">(</span><span class="s">'We sent the verification link to </span><span class="si">${user['email']}</span><span class="s">.'</span><span class="o">);</span>
</code></pre>
</div>

<p>Unfortunately, <code class="highlighter-rouge">JSON.decode()</code> merely returns a <code class="highlighter-rouge">Map&lt;String, dynamic&gt;</code>, meaning
that we do not know the types of the values until runtime. With this approach,
we lose most of the statically typed language features: type safety,
autocompletion and most importantly, compile-time exceptions. Our code can
become instantly more error-prone.</p>

<p>For example, whenever we access the <code class="highlighter-rouge">name</code> or <code class="highlighter-rouge">email</code> fields, we could quickly
introduce a typo. A typo which our compiler does not know of since our entire
JSON merely lives in a map structure.</p>

<h3 id="serializing-json-inside-model-classes">Serializing JSON inside model classes</h3>

<p>We can combat the previously mentioned problems by introducing a plain model
class, which we call <code class="highlighter-rouge">User</code>. Inside the <code class="highlighter-rouge">User</code> class, we have:</p>

<ul>
  <li>a <code class="highlighter-rouge">User.fromJson</code> constructor, for constructing a new <code class="highlighter-rouge">User</code> instance from a
map structure</li>
  <li>a <code class="highlighter-rouge">toJson</code> method, which converts a <code class="highlighter-rouge">User</code> instance into a map.</li>
</ul>

<p>This way, the <em>calling code</em> can now have type safety, autocompletion for the
<code class="highlighter-rouge">name</code> and <code class="highlighter-rouge">email</code> fields and compile-time exceptions. If we make typos or treat
the fields as <code class="highlighter-rouge">int</code>s instead of <code class="highlighter-rouge">String</code>s, our app will not even compile,
instead of crashing on runtime.</p>

<p><strong>user.dart</strong></p>

<!-- skip -->
<div class="language-dart highlighter-rouge"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
  <span class="kd">final</span> <span class="kt">String</span> <span class="n">name</span><span class="o">;</span>
  <span class="kd">final</span> <span class="kt">String</span> <span class="n">email</span><span class="o">;</span>

  <span class="n">User</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">name</span><span class="o">,</span> <span class="k">this</span><span class="o">.</span><span class="na">email</span><span class="o">);</span>

  <span class="n">User</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">,</span> <span class="kd">dynamic</span><span class="o">&gt;</span> <span class="n">json</span><span class="o">)</span>
      <span class="o">:</span> <span class="n">name</span> <span class="o">=</span> <span class="n">json</span><span class="o">[</span><span class="s">'name'</span><span class="o">],</span>
        <span class="n">email</span> <span class="o">=</span> <span class="n">json</span><span class="o">[</span><span class="s">'email'</span><span class="o">];</span>

  <span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">,</span> <span class="kd">dynamic</span><span class="o">&gt;</span> <span class="n">toJson</span><span class="o">()</span> <span class="o">=&gt;</span>
    <span class="o">{</span>
      <span class="s">'name'</span><span class="o">:</span> <span class="n">name</span><span class="o">,</span>
      <span class="s">'email'</span><span class="o">:</span> <span class="n">email</span><span class="o">,</span>
    <span class="o">};</span>
<span class="o">}</span>
</code></pre>
</div>

<p>Now the responsibility of the serialization logic is moved inside the model
itself. With this new approach, we can deserialize a user quite easily.</p>

<!-- skip -->
<div class="language-dart highlighter-rouge"><pre class="highlight"><code><span class="n">Map</span> <span class="n">userMap</span> <span class="o">=</span> <span class="n">JSON</span><span class="o">.</span><span class="na">decode</span><span class="o">(</span><span class="n">json</span><span class="o">);</span>
<span class="kd">var</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">userMap</span><span class="o">);</span>

<span class="n">print</span><span class="o">(</span><span class="s">'Howdy, </span><span class="si">${user.name}</span><span class="s">!'</span><span class="o">);</span>
<span class="n">print</span><span class="o">(</span><span class="s">'We sent the verification link to </span><span class="si">${user.email}</span><span class="s">.'</span><span class="o">);</span>
</code></pre>
</div>

<p>To serialize a user, we just pass the <code class="highlighter-rouge">User</code> object to the <code class="highlighter-rouge">JSON.encode</code> method.
We don’t need to call the <code class="highlighter-rouge">toJson</code> method here, since <code class="highlighter-rouge">JSON.encode</code> already does
it for us.</p>

<!-- skip -->
<div class="language-dart highlighter-rouge"><pre class="highlight"><code><span class="kt">String</span> <span class="n">json</span> <span class="o">=</span> <span class="n">JSON</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
</code></pre>
</div>

<p>This way, the calling code does not have to worry about JSON serialization at
all. However, the model class still definitely has to. In a production app, we
would want to be sure that the serialization works properly. In practice, the
<code class="highlighter-rouge">User.fromJson</code> and <code class="highlighter-rouge">User.toJson</code> methods both need to have unit tests in place
to verify correct behavior.</p>

<p>Also, real-world scenarios are not usually that simple. It is unlikely that we
can get by with such small JSON responses. Nested JSON objects are not that
uncommon either.</p>

<p>It would be nice if there were something that handled the JSON serialization for
us. Luckily, there is!</p>

<p><a name="code-generation"></a></p>
<h2 id="serializing-json-using-code-generation-libraries">Serializing JSON using code generation libraries</h2>

<p>Although there are other libraries available, in this tutorial, we use the
<a href="https://pub.dartlang.org/packages/json_serializable">json_serializable package</a>. It
is an automated source code generator that can generate the JSON serialization
boilerplate for us.</p>

<p>Since the serialization code is not handwritten and maintained by us anymore, we
minimize the risk of having JSON serialization exceptions at runtime.</p>

<h3 id="setting-up-json_serializable-in-a-project">Setting up json_serializable in a project</h3>

<p>To include <code class="highlighter-rouge">json_serializable</code> in our project, we need one regular and two <em>dev
dependencies</em>. In short, <em>dev dependencies</em> are dependencies that are not
included in our app source code.</p>

<p>The latest versions of these required dependencies can be seen by following
<a href="https://github.com/dart-lang/json_serializable/blob/master/example/pubspec.yaml">this link</a>.</p>

<p><strong>pubspec.yaml</strong></p>

<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">dependencies</span><span class="pi">:</span>
  <span class="c1"># Your other regular dependencies here</span>
  <span class="s">json_annotation</span><span class="pi">:</span> <span class="s">^0.2.2</span>

<span class="s">dev_dependencies</span><span class="pi">:</span>
  <span class="c1"># Your other dev_dependencies here</span>
  <span class="s">build_runner</span><span class="pi">:</span> <span class="s">^0.7.6</span>
  <span class="s">json_serializable</span><span class="pi">:</span> <span class="s">^0.3.2</span>
</code></pre>
</div>

<p>Run <code class="highlighter-rouge">flutter packages get</code> inside your project root folder (or click “Packages
Get” in your editor) to make these new dependencies available in your project.</p>

<h3 id="creating-model-classes-the-json_serializable-way">Creating model classes the json_serializable way</h3>

<p>Let’s see how to convert our <code class="highlighter-rouge">User</code> class to a <code class="highlighter-rouge">json_serializable</code> one. For the
sake of simplicity, we use the dumbed-down JSON model from the previous samples.</p>

<p><strong>user.dart</strong></p>

<!-- skip -->
<pre class="prettyprint highlighter-rouge highlight lang-dart language-dart"><code>import &#39;package:json_annotation/json_annotation.dart&#39;;

/// This allows our `User` class to access private members in 
/// the generated file. The value for this is *.g.dart, where 
/// the star denotes the source file name.
part &#39;<span class="nocode highlight">user</span>.g.dart&#39;;

/// An annotation for the code generator to know that this class needs the 
/// JSON serialization logic to be generated.
<span class="nocode highlight">@JsonSerializable()</span>

/// Every json_serializable class must have the serializer mixin. 
/// It makes the generated toJson() method to be usable for the class. 
/// The mixin&#39;s name follows the source class, in this case, User.
class User extends Object with _$<span class="nocode highlight">User</span>SerializerMixin {
  User(this.name, this.email);

  String name;
  String email;

  /// A necessary factory constructor for creating a new User instance
  /// from a map. We pass the map to the generated _$UserFromJson constructor. 
  /// The constructor is named after the source class, in this case User.
  factory User.fromJson(Map&lt;String, dynamic&gt; json) =&gt; _$<span class="nocode highlight">User</span>FromJson(json);
}</code></pre>

<p>With this setup, the source code generator will generate code for serializing
the <code class="highlighter-rouge">name</code> and <code class="highlighter-rouge">email</code> fields from JSON and back.</p>

<p>If needed, it is also easy to customize the naming strategy. For example, if the
API we are working with returns objects with <em>snake_case</em>, and we want to use
<em>lowerCamelCase</em> in our models, we can use the <code class="highlighter-rouge">@JsonKey</code> annotation with a name
parameter:</p>

<!-- skip -->
<div class="language-dart highlighter-rouge"><pre class="highlight"><code><span class="c1">/// Tell json_serializable that "registration_date_millis" should be</span>
<span class="c1">/// mapped to this property.</span>
<span class="nd">@JsonKey</span><span class="o">(</span><span class="nl">name:</span> <span class="s">'registration_date_millis'</span><span class="o">)</span>
<span class="kd">final</span> <span class="kt">int</span> <span class="n">registrationDateMillis</span><span class="o">;</span>
</code></pre>
</div>

<h3 id="running-the-code-generation-utility">Running the code generation utility</h3>

<p>When creating <code class="highlighter-rouge">json_serializable</code> classes the first time, you will get errors
similar to the image below.</p>

<p><img src="/images/json/ide_warning.png" alt="IDE warning when the generated code for a model class does not exist
yet." /></p>

<p>These errors are entirely normal and are simply because the generated code for
the model class does not exist yet. To resolve this, we must run the code
generator that generates the serialization boilerplate for us.</p>

<p>There are two ways of running the code generator.</p>

<h4 id="one-time-code-generation">One-time code generation</h4>

<p>By running <code class="highlighter-rouge">flutter packages pub run build_runner build</code> in our project root, we
can generate json serialization code for our models whenever needed. This
triggers a one-time build which goes through our source files, picks the
relevant ones and generates the necessary serialization code for them.</p>

<p>While this is pretty convenient, it would nice if we did not have to run the
build manually every time we make changes in our model classes.</p>

<h4 id="generating-code-continuously">Generating code continuously</h4>

<p>A <em>watcher</em> can make our source code generation process more convenient. It
watches changes in our project files and automatically builds the necessary
files when needed. We can start the watcher by running <code class="highlighter-rouge">flutter packages pub run
build_runner watch</code> in our project root.</p>

<p>It is safe to start the watcher once and leave it running in the background.</p>

<h3 id="consuming-json_serializable-models">Consuming json_serializable models</h3>

<p>To deserialize a JSON string <code class="highlighter-rouge">json_serializable</code> way, we do not have actually to
make any changes to our previous code.</p>

<!-- skip -->
<div class="language-dart highlighter-rouge"><pre class="highlight"><code><span class="n">Map</span> <span class="n">userMap</span> <span class="o">=</span> <span class="n">JSON</span><span class="o">.</span><span class="na">decode</span><span class="o">(</span><span class="n">json</span><span class="o">);</span>
<span class="kd">var</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">userMap</span><span class="o">);</span>
</code></pre>
</div>

<p>Same goes for serialization. The calling API is the same as before.</p>

<!-- skip -->
<div class="language-dart highlighter-rouge"><pre class="highlight"><code><span class="kt">String</span> <span class="n">json</span> <span class="o">=</span> <span class="n">JSON</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
</code></pre>
</div>

<p>With <code class="highlighter-rouge">json_serializable</code>, we can forget any manual JSON serialization in the
<code class="highlighter-rouge">User</code> class. The source code generator creates a file called <code class="highlighter-rouge">user.g.dart</code>,
which has all the necessary serialization logic. Now we do not necessarily have
to write automated tests to be sure that the serialization works - it is now
<em>the library’s responsibility</em> to make sure the serialization works
appropriately.</p>

<h2 id="further-references">Further references</h2>

<ul>
  <li><a href="https://api.dartlang.org/stable/1.24.3/dart-convert/JsonCodec-class.html">JsonCodec documentation</a></li>
  <li><a href="https://pub.dartlang.org/packages/json_serializable">The json_serializable package in Pub</a></li>
  <li><a href="https://github.com/dart-lang/json_serializable/blob/master/example/lib/example.dart">json_serializable examples in GitHub</a></li>
  <li><a href="https://github.com/flutter/flutter/issues/1150">Discussion about dart:mirrors in Flutter</a></li>
</ul>

</article>

          </div>
        </div>

        

      </div> <!-- /.row -->
    </div> <!-- /.container -->

    <footer class="site-footer">
  <div class="container-fluid">
    <div class="row">
      <div class="col-sm-12">
        <div class="logo">
          <img src="/images/flutter-mark-square-100.png" alt="Flutter Logo" width="100" height="100">
        </div>
        <p class="site-footer__link-list">
          <a href="https://groups.google.com/forum/#!forum/flutter-dev">flutter-dev@</a> &bull;
          <a href="https://twitter.com/flutterio">twitter</a> &bull;
          <a href="https://github.com/flutter/">github</a> &bull;
          <a href="/tos">terms</a> &bull;
          <a href="https://www.google.com/intl/en/policies/privacy/">privacy</a> &bull;
          <a href="https://github.com/orgs/flutter-dev/teams/flutter/">翻译组</a>
        </p>

        <p class="licenses">
          除非另有说明，否则本作品根据
          <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">知识共享署名 4.0 国际许可证</a>进行许可，代码示例已根据 BSD 许可证进行许可。
        </p>
      </div>
    </div>
  </div>
</footer>

    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="/js/sidebar_toggle.js"></script>
    <script src="/js/customscripts.js"></script>
    <script src="/js/prism.js"></script>
    <script src="/js/tabs.js"></script>
    
    <script async="" defer="" src="//survey.g.doubleclick.net/async_survey?site=at3ul57xpub2vk3oxt2ytw365i"></script>
  </body>
</html>
